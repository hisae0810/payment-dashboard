<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>æ”¯æ‰•ã‚µã‚¤ãƒˆçŸ­ç¸®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆè¦–çš„ãƒ•ãƒ­ãƒ¼ï¼‰</title>
<style>
  body { font-family: "Yu Gothic","Hiragino Kaku Gothic ProN", Meiryo, sans-serif; margin:20px; color:#222; background:#f9fafb; }
  header { display:flex; align-items:center; gap:12px; margin-bottom:12px; }
  header h1 { font-size:20px; margin:0; }
  .grid { display:grid; grid-template-columns: 1fr 480px 1fr; gap:16px; align-items:start; }
  .panel { background:#fff; border:1px solid #e0e0e0; border-radius:8px; padding:12px; box-shadow:0 1px 3px rgba(0,0,0,0.04); }
  .panel h2 { margin:0 0 8px 0; font-size:16px; display:flex; align-items:center; gap:8px; }
  ul.list { list-style:none; padding:0; margin:0; max-height:520px; overflow:auto; }
  li.item { padding:6px 8px; border-bottom:1px solid #f4f4f4; display:flex; align-items:center; gap:8px; cursor:pointer; transition: background 0.2s, opacity 0.2s; }
  li.item:hover { background:#f0f4f8; }
  li.item.selected { background:#dbeafe; border-left:3px solid #2b6cb0; }
  li.item.completed { opacity:0.6; }
  li.item.completed .name { text-decoration:line-through; color:#999; }
  .item-checkbox { cursor:pointer; width:16px; height:16px; flex-shrink:0; }
  .item-content { flex:1; display:flex; justify-content:space-between; align-items:center; gap:8px; }
  .badge { font-size:12px; color:#666; padding:2px 6px; border-radius:4px; background:#f3f4f6; }
  .badge.done { background:#d1fae5; color:#065f46; }
  .controls { margin-bottom:8px; display:flex; gap:8px; }
  .stats { font-size:12px; color:#666; margin-left:4px; }
  input[type="text"]{ padding:6px 8px; border:1px solid #ccc; border-radius:4px; width:100%; box-sizing:border-box;}
  button{ padding:6px 10px; border-radius:4px; border:1px solid #2b6cb0; background:#2b6cb0; color:#fff; cursor:pointer;}
  button.secondary{ background:#fff; color:#2b6cb0;}
  
  /* CSSè£½ãƒ•ãƒ­ãƒ¼å›³ */
  .flow-diagram { background:#fafafa; padding:20px; border-radius:6px; min-height:360px; }
  .flow-box { background:#e0e7ff; border:2px solid #6366f1; border-radius:8px; padding:12px; margin:10px auto; max-width:280px; text-align:center; font-size:13px; font-weight:600; }
  .flow-box.green { background:#d1fae5; border-color:#10b981; }
  .flow-box.orange { background:#fed7aa; border-color:#f59e0b; }
  .flow-arrow { text-align:center; font-size:20px; color:#6366f1; margin:5px 0; }
  .flow-split { display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin:20px 0; }
  .flow-merge { position:relative; margin:20px 0; }
  .flow-merge::before { content:''; position:absolute; top:-10px; left:50%; width:2px; height:20px; background:#6366f1; }
  
  .selection-info { margin-top:12px; padding:10px; background:#fffbeb; border:1px solid #fbbf24; border-radius:6px; min-height:60px; }
  .selection-info.hidden { display:none; }
  .selection-info h3 { margin:0 0 6px 0; font-size:14px; color:#92400e; }
  .selection-info p { margin:4px 0; font-size:13px; color:#78350f; }
  
  /* ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— */
  .roadmap { margin-top:16px; }
  .roadmap-timeline { display:grid; grid-template-columns: repeat(3, 1fr); gap:12px; margin-top:12px; }
  .phase { background:#fff; border:1px solid #e0e0e0; border-radius:8px; padding:12px; position:relative; }
  .phase-header { display:flex; align-items:center; gap:8px; margin-bottom:8px; padding-bottom:8px; border-bottom:2px solid #e0e0e0; }
  .phase-icon { font-size:24px; }
  .phase-title { font-weight:600; font-size:14px; }
  .phase-days { font-size:12px; color:#666; margin-left:auto; }
  .phase.phase-1 .phase-header { border-bottom-color:#10b981; }
  .phase.phase-2 .phase-header { border-bottom-color:#f59e0b; }
  .phase.phase-3 .phase-header { border-bottom-color:#8b5cf6; }
  .task-list { list-style:none; padding:0; margin:8px 0 0 0; }
  .task-item { padding:4px 0; font-size:13px; display:flex; align-items:start; gap:6px; }
  .task-item input[type="checkbox"] { margin-top:2px; cursor:pointer; }
  .task-item label { cursor:pointer; flex:1; }
  .task-item input[type="checkbox"]:checked + label { text-decoration:line-through; color:#999; }
  
  /* å‚™è€ƒæ¬„ */
  .memo-section { margin-top:16px; }
  .memo-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
  .memo-header h2 { margin:0; }
  .memo-timestamp { font-size:12px; color:#666; }
  textarea.memo-area { width:100%; min-height:150px; padding:12px; border:1px solid #e0e0e0; border-radius:6px; font-family:inherit; font-size:14px; resize:vertical; box-sizing:border-box; }
  .memo-controls { margin-top:8px; display:flex; gap:8px; align-items:center; }
  .save-status { font-size:12px; color:#10b981; margin-left:8px; }
  
  footer { margin-top:12px; font-size:13px; color:#666; }
  .count { font-weight:600; color:#2b6cb0; }
  @media(max-width:980px){ 
    .grid{ grid-template-columns: 1fr; }
    .roadmap-timeline { grid-template-columns: 1fr; }
    .flow-split { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
<header>
  <div style="font-size:28px;">ğŸ”</div>
  <h1>æ”¯æ‰•ã‚µã‚¤ãƒˆçŸ­ç¸®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆè¦–çš„ãƒ•ãƒ­ãƒ¼ï¼‰</h1>
</header>

<div class="grid">
  <!-- å·¦ï¼šçµ±ä¸€æ¸ˆã¿æ³•äºº -->
  <section class="panel" id="panel-left">
    <h2>
      âœ… æ”¯æ‰•æ¡ä»¶ãŒçµ±ä¸€ã•ã‚Œã¦ã„ã‚‹æ³•äºº 
      <span class="count" id="count-unified"></span>
      <span class="stats" id="stats-unified"></span>
    </h2>
    <div class="controls">
      <input type="text" id="filter-unified" placeholder="æ³•äººåã§ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰" />
      <button id="export-unified" class="secondary">CSVå‡ºåŠ›</button>
    </div>
    <ul class="list" id="list-unified"></ul>
  </section>

  <!-- ä¸­å¤®ï¼šãƒ•ãƒ­ãƒ¼å›³ -->
  <section class="panel" id="panel-center">
    <h2>ğŸ” è¦–çš„ãƒ•ãƒ­ãƒ¼</h2>
    <div class="flow-diagram">
      <div class="flow-box">å…¥åŠ›ï¼šæ³•äººãƒªã‚¹ãƒˆ<br>ï¼ˆæ”¯åº—è¡¨è¨˜ã‚’çœç•¥ï¼‰</div>
      <div class="flow-arrow">â†“</div>
      <div class="flow-box">æ³•äººã”ã¨ã«æ”¯æ‰•æ¡ä»¶ã‚’é›†ç´„</div>
      <div class="flow-arrow">â†“</div>
      
      <div class="flow-split">
        <div>
          <div class="flow-box green">çµ±ä¸€ã•ã‚Œã¦ã„ã‚‹æ³•äºº</div>
          <div class="flow-arrow">â†“</div>
          <div class="flow-box green" style="font-size:11px;">æœ¬ç¤¾æ‰¿è«¾ã‚’å–å¾—<br>â†“<br>ä¸€æ‹¬çŸ­ç¸®ææ¡ˆ<br>(Quick Win)</div>
        </div>
        <div>
          <div class="flow-box orange">ã°ã‚‰ã¤ããŒã‚ã‚‹æ³•äºº</div>
          <div class="flow-arrow">â†“</div>
          <div class="flow-box orange" style="font-size:11px;">éƒ¨ç½²å·®åˆ†ã‚’èª¿æŸ»<br>â†“<br>ç¤¾å†…çµ±ä¸€æ¡ˆä½œæˆ<br>â†“<br>æœ¬ç¤¾æ‰¿è«¾<br>â†“<br>çŸ­ç¸®ææ¡ˆ</div>
        </div>
      </div>
      
      <div class="flow-merge">
        <div class="flow-arrow">â†“</div>
        <div class="flow-box">åˆæ„â†’æ‰‹ç¶šâ†’é‹ç”¨ãƒ»åŠ¹æœæ¸¬å®š</div>
      </div>
    </div>

    <!-- é¸æŠä¸­ã®æ³•äººæƒ…å ± -->
    <div class="selection-info hidden" id="selection-info">
      <h3>ğŸ“Œ é¸æŠä¸­ã®æ³•äºº</h3>
      <p id="selected-name" style="font-weight:600; font-size:14px;"></p>
      <p id="selected-action"></p>
    </div>
  </section>

  <!-- å³ï¼šã°ã‚‰ã¤ãæ³•äºº -->
  <section class="panel" id="panel-right">
    <h2>
      âŒ æ”¯æ‰•æ¡ä»¶ãŒã°ã‚‰ã¤ãæ³•äºº 
      <span class="count" id="count-mixed"></span>
      <span class="stats" id="stats-mixed"></span>
    </h2>
    <div class="controls">
      <input type="text" id="filter-mixed" placeholder="æ³•äººåã§ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰" />
      <button id="export-mixed" class="secondary">CSVå‡ºåŠ›</button>
    </div>
    <ul class="list" id="list-mixed"></ul>
  </section>
</div>

<!-- ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— -->
<section class="panel roadmap">
  <h2>ğŸ—“ï¸ å®Ÿè¡Œãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼ˆ30/60/90æ—¥ï¼‰</h2>
  <div class="roadmap-timeline">
    <!-- ãƒ•ã‚§ãƒ¼ã‚º1: 0-30æ—¥ -->
    <div class="phase phase-1">
      <div class="phase-header">
        <span class="phase-icon">ğŸš€</span>
        <span class="phase-title">ãƒ•ã‚§ãƒ¼ã‚º1: Quick Win</span>
        <span class="phase-days">0-30æ—¥</span>
      </div>
      <ul class="task-list">
        <li class="task-item">
          <input type="checkbox" id="task1-1">
          <label for="task1-1">çµ±ä¸€æ¸ˆã¿æ³•äººã®å„ªå…ˆé †ä½ä»˜ã‘ï¼ˆå£²ä¸ŠÃ—ã‚µã‚¤ãƒˆï¼‰</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task1-2">
          <label for="task1-2">æœ¬ç¤¾æ‰¿è«¾ã‚¢ãƒå–å¾—ï¼ˆä¸Šä½3-5ç¤¾ï¼‰</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task1-3">
          <label for="task1-3">ç¤¾å†…ã‚­ãƒ¼ãƒãƒ³ï¼ˆè³¼è²·ãƒ»ä¸ä¿¡ãƒ»çµŒç†ï¼‰æ ¹å›ã—</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task1-4">
          <label for="task1-4">ã§ã‚“ã•ã„å°å…¥å¯å¦ã®äº‹å‰ç¢ºèª</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task1-5">
          <label for="task1-5">å¾—æ„å…ˆã¸çŸ­ç¸®æ¡ˆæç¤ºï¼ˆ1-3ç¤¾ï¼‰</label>
        </li>
      </ul>
    </div>

    <!-- ãƒ•ã‚§ãƒ¼ã‚º2: 31-60æ—¥ -->
    <div class="phase phase-2">
      <div class="phase-header">
        <span class="phase-icon">âš™ï¸</span>
        <span class="phase-title">ãƒ•ã‚§ãƒ¼ã‚º2: çµ±ä¸€æ¡ˆä»¶å¯¾å¿œ</span>
        <span class="phase-days">31-60æ—¥</span>
      </div>
      <ul class="task-list">
        <li class="task-item">
          <input type="checkbox" id="task2-1">
          <label for="task2-1">ã°ã‚‰ã¤ãæ¡ˆä»¶ã®éƒ¨ç½²åˆ¥å·®åˆ†è¡¨ä½œæˆ</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task2-2">
          <label for="task2-2">ä»–éƒ¨é–€ã¸ãƒ’ã‚¢ãƒªãƒ³ã‚°ï¼ˆå·®åˆ†ç†ç”±ç¢ºèªï¼‰</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task2-3">
          <label for="task2-3">ç¤¾å†…çµ±ä¸€æ¡ˆä½œæˆâ†’æœ¬ç¤¾æ‰¿èª</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task2-4">
          <label for="task2-4">çµ±ä¸€æ¸ˆã¿æ¡ˆä»¶ã®åˆæ„ç· çµãƒ»æ‰‹ç¶šé–‹å§‹</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task2-5">
          <label for="task2-5">ã§ã‚“ã•ã„å°å…¥æ”¯æ´ï¼ˆéŠ€è¡Œæ‰‹ç¶šï¼‰</label>
        </li>
      </ul>
    </div>

    <!-- ãƒ•ã‚§ãƒ¼ã‚º3: 61-90æ—¥ -->
    <div class="phase phase-3">
      <div class="phase-header">
        <span class="phase-icon">ğŸ“Š</span>
        <span class="phase-title">ãƒ•ã‚§ãƒ¼ã‚º3: é‹ç”¨ãƒ»åŠ¹æœæ¸¬å®š</span>
        <span class="phase-days">61-90æ—¥</span>
      </div>
      <ul class="task-list">
        <li class="task-item">
          <input type="checkbox" id="task3-1">
          <label for="task3-1">çŸ­ç¸®æ¡ˆä»¶ã®é‹ç”¨é–‹å§‹ãƒ»åˆå›æ”¯æ‰•ç¢ºèª</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task3-2">
          <label for="task3-2">ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ•ãƒ­ãƒ¼æ”¹å–„åŠ¹æœã®æ¸¬å®š</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task3-3">
          <label for="task3-3">æˆåŠŸäº‹ä¾‹ã®ãƒ†ãƒ³ãƒ—ãƒ¬åŒ–ãƒ»æ¨ªå±•é–‹æº–å‚™</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task3-4">
          <label for="task3-4">ã°ã‚‰ã¤ãæ¡ˆä»¶ã®å¾—æ„å…ˆäº¤æ¸‰é–‹å§‹</label>
        </li>
        <li class="task-item">
          <input type="checkbox" id="task3-5">
          <label for="task3-5">æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºï¼ˆä¸­å„ªå…ˆæ¡ˆä»¶ï¼‰è¨ˆç”»ç­–å®š</label>
        </li>
      </ul>
    </div>
  </div>
</section>

<!-- å‚™è€ƒæ¬„ -->
<section class="panel memo-section">
  <div class="memo-header">
    <h2>ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®å‚™è€ƒãƒ»ãƒ¡ãƒ¢</h2>
    <span class="memo-timestamp" id="memo-timestamp"></span>
  </div>
  <textarea class="memo-area" id="memo-area" placeholder="ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ãƒ¡ãƒ¢ã‚„é‡è¦äº‹é …ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„...&#10;&#10;ä¾‹ï¼š&#10;2024/11/15&#10;ãƒ»ã‚¢ãƒ«ãƒ†ã‚¢æŠ€ç ”ï¼šæœ¬ç¤¾ã«é€£çµ¡æ¸ˆã¿ã€æ¥é€±å›ç­”äºˆå®š&#10;ãƒ»ã‚½ãƒ«ãƒ–ï¼šã§ã‚“ã•ã„å°å…¥ã®å¯å¦ç¢ºèªä¸­"></textarea>
  <div class="memo-controls">
    <button id="save-memo">ä¿å­˜</button>
    <span class="save-status" id="save-status"></span>
  </div>
</section>

<footer>
  <div>æ³¨ï¼šãƒ¯ã‚³ãƒ¼å•†äº‹ãƒ»æ±æµ·åŒ»ç™‚ã¯æ—¢ã«çŸ­ç¸®æ¸ˆã¿ã®ãŸã‚ä¸€è¦§ã‹ã‚‰é™¤å¤–æ¸ˆã¿ã€‚æ—¥æœ¬èˆ¹èˆ¶è–¬å“ã¯ä¸€æ—¦ä¿ç•™ï¼ˆã°ã‚‰ã¤ãã‚°ãƒ«ãƒ¼ãƒ—ï¼‰ã€‚</div>
  <div style="margin-top:6px;color:#2b6cb0;">âœ… CSVå‡ºåŠ›ã¯æ–‡å­—åŒ–ã‘å¯¾ç­–æ¸ˆã¿ï¼ˆUTF-8 BOMä»˜ãï¼‰ã€‚Excelã§ç›´æ¥é–‹ã‘ã¾ã™ã€‚</div>
  <div style="margin-top:6px;color:#059669;">ğŸ’¡ æ³•äººåã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨é¸æŠçŠ¶æ…‹ã«ãªã‚Šã€æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
  <div style="margin-top:6px;color:#8b5cf6;">ğŸ“… ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§é€²æ—ã‚’ç®¡ç†ã§ãã¾ã™ã€‚</div>
  <div style="margin-top:6px;color:#dc2626;">âœ”ï¸ å¾—æ„å…ˆåã®å‰ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§å¯¾å¿œçŠ¶æ³ã‚’ç®¡ç†ã§ãã¾ã™ï¼ˆè‡ªå‹•ä¿å­˜ï¼‰ã€‚</div>
  <div style="margin-top:6px;color:#f59e0b;">ğŸ“ å‚™è€ƒæ¬„ã¯å…¥åŠ›å¾Œ3ç§’ã§è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã™ã€‚</div>
</footer>

<script>
(function() {
  'use strict';
  
  // ãƒ‡ãƒ¼ã‚¿å®šç¾©
  var unified = [
    "ã‚¢ãƒ«ãƒ†ã‚¢æŠ€ç ”æ ªå¼ä¼šç¤¾",
    "ã‚½ãƒ«ãƒ–æ ªå¼ä¼šç¤¾",
    "æ ªå¼ä¼šç¤¾ã„ã‚ã—ã‚„éŒ¦ç¹”åŒ»ç§‘å™¨æ¢°",
    "æ ªå¼ä¼šç¤¾ã„ã‚ã—ã‚„è¥¿æ–¹åŒ»ç§‘å™¨æ¢°",
    "æ ªå¼ä¼šç¤¾ã‚¨ãƒ ãƒ»ã‚¢ã‚¤ãƒ»ã‚·ãƒ¼",
    "æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ©ã‚¤ãƒ•",
    "æ ªå¼ä¼šç¤¾ãƒã‚¹ãƒˆãƒ¬ãƒ¡ãƒ‡ã‚£ã‚«ãƒ«",
    "æ ªå¼ä¼šç¤¾ãƒãƒ„ã‚¤",
    "æ ªå¼ä¼šç¤¾æ±Ÿç”°å•†ä¼š",
    "æ ªå¼ä¼šç¤¾é™å²¡åŒ»ç§‘å™¨æ¢°",
    "æ±æµ·æ•™è‚²ç”£æ¥­æ ªå¼ä¼šç¤¾",
    "æ±è¥¿åŒ»ç”¨å™¨æ ªå¼ä¼šç¤¾",
    "æ—¥æœ¬äº‹å‹™å™¨æ ªå¼ä¼šç¤¾"
  ];

  var mixed = [
    "ãƒŸã‚ºãƒ›æ ªå¼ä¼šç¤¾",
    "æ ªå¼ä¼šç¤¾ã‚«ã‚¤ã‚»ã‚¤åŒ»ç™‚å™¨",
    "æ ªå¼ä¼šç¤¾å·´å•†ä¼š",
    "å”å’ŒåŒ»ç§‘å™¨æ¢°æ ªå¼ä¼šç¤¾",
    "æ—¥æœ¬é›»å­å¿œç”¨æ ªå¼ä¼šç¤¾",
    "æ—¥æœ¬èˆ¹èˆ¶è–¬å“æ ªå¼ä¼šç¤¾",
    "é•·æ´¥åŒ»ç§‘å™¨æ¢°æ ªå¼ä¼šç¤¾",
    "æ ªå¼ä¼šç¤¾æ±æ˜ã‚µã‚¤ã‚¨ãƒ³ã‚¹"
  ];

  // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
  var currentSelected = null;
  var listUnified, listMixed, countUnified, countMixed, statsUnified, statsMixed;
  var selectionInfo, selectedName, selectedAction;
  var memoArea, memoTimestamp, saveStatus;
  var autoSaveTimer;

  // åˆæœŸåŒ–é–¢æ•°
  function init() {
    // DOMè¦ç´ å–å¾—
    listUnified = document.getElementById("list-unified");
    listMixed = document.getElementById("list-mixed");
    countUnified = document.getElementById("count-unified");
    countMixed = document.getElementById("count-mixed");
    statsUnified = document.getElementById("stats-unified");
    statsMixed = document.getElementById("stats-mixed");
    selectionInfo = document.getElementById("selection-info");
    selectedName = document.getElementById("selected-name");
    selectedAction = document.getElementById("selected-action");
    memoArea = document.getElementById("memo-area");
    memoTimestamp = document.getElementById("memo-timestamp");
    saveStatus = document.getElementById("save-status");
    
    // åˆæœŸæç”»
    renderList(listUnified, unified, "çµ±ä¸€æ¸ˆã¿");
    renderList(listMixed, mixed, "ã°ã‚‰ã¤ã");
    countUnified.textContent = "(" + unified.length + ")";
    countMixed.textContent = "(" + mixed.length + ")";
    updateStats(unified, statsUnified);
    updateStats(mixed, statsMixed);
    
    // å‚™è€ƒæ¬„ã®åˆæœŸåŒ–
    loadMemo();
    
    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
    setupEventListeners();
  }

  // å¾—æ„å…ˆã®å®Œäº†çŠ¶æ…‹ã‚’å–å¾—
  function getCompanyStatus(name) {
    try {
      return localStorage.getItem('company_' + name) === 'true';
    } catch(e) {
      return false;
    }
  }

  // å¾—æ„å…ˆã®å®Œäº†çŠ¶æ…‹ã‚’ä¿å­˜
  function setCompanyStatus(name, status) {
    try {
      localStorage.setItem('company_' + name, status);
    } catch(e) {
      console.log('localStorageä¿å­˜ã‚¨ãƒ©ãƒ¼');
    }
  }

  // å‚™è€ƒã‚’èª­ã¿è¾¼ã¿
  function loadMemo() {
    try {
      var memo = localStorage.getItem('project_memo') || '';
      var timestamp = localStorage.getItem('project_memo_timestamp') || '';
      memoArea.value = memo;
      if (timestamp) {
        memoTimestamp.textContent = 'æœ€çµ‚æ›´æ–°: ' + timestamp;
      }
    } catch(e) {
      console.log('å‚™è€ƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼');
    }
  }

  // å‚™è€ƒã‚’ä¿å­˜
  function saveMemo() {
    try {
      var memo = memoArea.value;
      var now = new Date();
      var timestamp = now.getFullYear() + '/' + 
                     (now.getMonth() + 1) + '/' + 
                     now.getDate() + ' ' + 
                     now.getHours() + ':' + 
                     ('0' + now.getMinutes()).slice(-2);
      
      localStorage.setItem('project_memo', memo);
      localStorage.setItem('project_memo_timestamp', timestamp);
      memoTimestamp.textContent = 'æœ€çµ‚æ›´æ–°: ' + timestamp;
      
      // ä¿å­˜å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
      saveStatus.textContent = 'âœ“ ä¿å­˜ã—ã¾ã—ãŸ';
      setTimeout(function() {
        saveStatus.textContent = '';
      }, 2000);
    } catch(e) {
      saveStatus.textContent = 'âœ— ä¿å­˜ã‚¨ãƒ©ãƒ¼';
      console.log('å‚™è€ƒä¿å­˜ã‚¨ãƒ©ãƒ¼');
    }
  }

  // çµ±è¨ˆã‚’æ›´æ–°
  function updateStats(items, statsElem) {
    var completed = 0;
    for (var i = 0; i < items.length; i++) {
      if (getCompanyStatus(items[i])) completed++;
    }
    statsElem.textContent = '(å¯¾å¿œæ¸ˆã¿: ' + completed + '/' + items.length + ')';
  }

  // ãƒªã‚¹ãƒˆæç”»
  function renderList(listElem, items, group) {
    listElem.innerHTML = "";
    
    for (var i = 0; i < items.length; i++) {
      var name = items[i];
      var li = document.createElement("li");
      li.className = "item";
      
      var isCompleted = getCompanyStatus(name);
      if (isCompleted) {
        li.classList.add("completed");
      }
      
      // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
      var checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.className = "item-checkbox";
      checkbox.checked = isCompleted;
      checkbox.setAttribute('data-name', name);
      checkbox.setAttribute('data-group', group);
      
      // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
      var content = document.createElement("div");
      content.className = "item-content";
      content.setAttribute('data-name', name);
      content.setAttribute('data-group', group);
      
      var nameSpan = document.createElement("span");
      nameSpan.className = "name";
      nameSpan.textContent = name;
      
      var badgeSpan = document.createElement("span");
      badgeSpan.className = isCompleted ? "badge done" : "badge";
      badgeSpan.textContent = isCompleted ? "å¯¾å¿œæ¸ˆã¿" : group;
      
      content.appendChild(nameSpan);
      content.appendChild(badgeSpan);
      
      li.appendChild(checkbox);
      li.appendChild(content);
      listElem.appendChild(li);
    }
  }

  // æ³•äººé¸æŠ
  function selectCompany(elem, name, group) {
    if (currentSelected === elem) {
      elem.classList.remove("selected");
      selectionInfo.classList.add("hidden");
      currentSelected = null;
      return;
    }
    
    if (currentSelected) {
      currentSelected.classList.remove("selected");
    }
    
    elem.classList.add("selected");
    currentSelected = elem;
    
    selectedName.textContent = name;
    
    if (group === "çµ±ä¸€æ¸ˆã¿") {
      selectedAction.innerHTML = 
        "ğŸ¯ <strong>æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br>" +
        "â‘  æœ¬ç¤¾ï¼ˆã¾ãŸã¯è³¼è²·ãƒ»çµŒç†è²¬ä»»è€…ï¼‰ã«æ‰¿è«¾ã‚’ä¾é ¼<br>" +
        "â‘¡ æ‰¿è«¾å¾Œã€å¾—æ„å…ˆã¸ä¸€æ‹¬çŸ­ç¸®ææ¡ˆï¼ˆã§ã‚“ã•ã„å°å…¥ç­‰ï¼‰<br>" +
        "â‘¢ åˆæ„â†’æ‰‹ç¶šâ†’é‹ç”¨é–‹å§‹â†’åŠ¹æœæ¸¬å®š";
    } else {
      selectedAction.innerHTML = 
        "ğŸ¯ <strong>æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼š</strong><br>" +
        "â‘  éƒ¨ç½²åˆ¥ã®æ”¯æ‰•æ¡ä»¶å·®åˆ†ã‚’èª¿æŸ»ï¼ˆãªãœé•ã†ã‹ç†ç”±ç¢ºèªï¼‰<br>" +
        "â‘¡ ç¤¾å†…ã§çµ±ä¸€æ¡ˆã‚’ä½œæˆâ†’æœ¬ç¤¾æ‰¿èª<br>" +
        "â‘¢ æ‰¿èªå¾Œã€å¾—æ„å…ˆã¸çŸ­ç¸®ææ¡ˆâ†’åˆæ„â†’é‹ç”¨é–‹å§‹";
    }
    
    selectionInfo.classList.remove("hidden");
  }

  // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
  function setupEventListeners() {
    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚¯ãƒªãƒƒã‚¯
    document.getElementById('list-unified').addEventListener('click', function(e) {
      if (e.target.classList.contains('item-checkbox')) {
        var name = e.target.getAttribute('data-name');
        var group = e.target.getAttribute('data-group');
        var newStatus = e.target.checked;
        setCompanyStatus(name, newStatus);
        var li = e.target.parentElement;
        if (newStatus) {
          li.classList.add("completed");
          li.querySelector('.badge').textContent = 'å¯¾å¿œæ¸ˆã¿';
          li.querySelector('.badge').classList.add('done');
        } else {
          li.classList.remove("completed");
          li.querySelector('.badge').textContent = group;
          li.querySelector('.badge').classList.remove('done');
        }
        updateStats(unified, statsUnified);
      } else if (e.target.closest('.item-content')) {
        var content = e.target.closest('.item-content');
        var name = content.getAttribute('data-name');
        var group = content.getAttribute('data-group');
        var li = content.parentElement;
        selectCompany(li, name, group);
      }
    });
    
    document.getElementById('list-mixed').addEventListener('click', function(e) {
      if (e.target.classList.contains('item-checkbox')) {
        var name = e.target.getAttribute('data-name');
        var group = e.target.getAttribute('data-group');
        var newStatus = e.target.checked;
        setCompanyStatus(name, newStatus);
        var li = e.target.parentElement;
        if (newStatus) {
          li.classList.add("completed");
          li.querySelector('.badge').textContent = 'å¯¾å¿œæ¸ˆã¿';
          li.querySelector('.badge').classList.add('done');
        } else {
          li.classList.remove("completed");
          li.querySelector('.badge').textContent = group;
          li.querySelector('.badge').classList.remove('done');
        }
        updateStats(mixed, statsMixed);
      } else if (e.target.closest('.item-content')) {
        var content = e.target.closest('.item-content');
        var name = content.getAttribute('data-name');
        var group = content.getAttribute('data-group');
        var li = content.parentElement;
        selectCompany(li, name, group);
      }
    });
    
    // ãƒ•ã‚£ãƒ«ã‚¿
    document.getElementById("filter-unified").addEventListener("input", function(){
      var q = this.value.trim();
      var filtered = [];
      for (var i = 0; i < unified.length; i++) {
        if (unified[i].indexOf(q) !== -1) {
          filtered.push(unified[i]);
        }
      }
      renderList(listUnified, filtered, "çµ±ä¸€æ¸ˆã¿");
      currentSelected = null;
      selectionInfo.classList.add("hidden");
      updateStats(filtered, statsUnified);
    });
    
    document.getElementById("filter-mixed").addEventListener("input", function(){
      var q = this.value.trim();
      var filtered = [];
      for (var i = 0; i < mixed.length; i++) {
        if (mixed[i].indexOf(q) !== -1) {
          filtered.push(mixed[i]);
        }
      }
      renderList(listMixed, filtered, "ã°ã‚‰ã¤ã");
      currentSelected = null;
      selectionInfo.classList.add("hidden");
      updateStats(filtered, statsMixed);
    });
    
    // CSVå‡ºåŠ›
    document.getElementById("export-unified").addEventListener("click", function(){
      var csv = "æ³•äººå,å¯¾å¿œçŠ¶æ³\n" + toCSV(unified);
      downloadCSV("unified_companies.csv", csv);
    });
    
    document.getElementById("export-mixed").addEventListener("click", function(){
      var csv = "æ³•äººå,å¯¾å¿œçŠ¶æ³\n" + toCSV(mixed);
      downloadCSV("mixed_companies.csv", csv);
    });
    
    // ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
    var checkboxes = document.querySelectorAll('.task-item input[type="checkbox"]');
    for (var i = 0; i < checkboxes.length; i++) {
      var cb = checkboxes[i];
      try {
        var saved = localStorage.getItem(cb.id);
        if (saved === 'true') cb.checked = true;
      } catch(e) {}
      
      cb.addEventListener('change', function() {
        try {
          localStorage.setItem(this.id, this.checked);
        } catch(e) {}
      });
    }
    
    // å‚™è€ƒæ¬„ã®ä¿å­˜ãƒœã‚¿ãƒ³
    document.getElementById('save-memo').addEventListener('click', function() {
      saveMemo();
    });
    
    // å‚™è€ƒæ¬„ã®è‡ªå‹•ä¿å­˜ï¼ˆå…¥åŠ›å¾Œ3ç§’ï¼‰
    memoArea.addEventListener('input', function() {
      clearTimeout(autoSaveTimer);
      autoSaveTimer = setTimeout(function() {
        saveMemo();
      }, 3000);
    });
  }

  // CSVé–¢é€£
  function toCSV(arr){ 
    var lines = [];
    for (var i = 0; i < arr.length; i++) {
      var s = arr[i];
      var status = getCompanyStatus(s) ? 'å¯¾å¿œæ¸ˆã¿' : 'æœªå¯¾å¿œ';
      lines.push('"' + s.replace(/"/g,'""') + '","' + status + '"');
    }
    return lines.join("\n");
  }

  function downloadCSV(filename, content) {
    var csv = "\uFEFF" + content;
    var blob = new Blob([csv], {type: 'text/csv;charset=utf-8;'});
    var url = URL.createObjectURL(blob);
    var a = document.createElement("a");
    a.href = url;
    a.download = filename;
    a.click();
    URL.revokeObjectURL(url);
  }

  // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å¾Œã«å®Ÿè¡Œ
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
</body>
</html>